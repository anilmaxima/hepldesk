{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useEffect } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { API_URL } from \"../config\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function AdminDashboard(_ref) {\n  var navigation = _ref.navigation,\n    setRole = _ref.setRole;\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    tickets = _useState2[0],\n    setTickets = _useState2[1];\n  var fetchTickets = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      try {\n        var res = yield fetch(API_URL + \"/api/tickets\");\n        var data = yield res.json();\n        setTickets(data);\n      } catch (err) {\n        console.error(err);\n        Alert.alert(\"Error\", \"Failed to fetch tickets\");\n      }\n    });\n    return function fetchTickets() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var updateStatus = function () {\n    var _ref3 = _asyncToGenerator(function* (id, status) {\n      try {\n        var res = yield fetch(API_URL + \"/api/tickets/\" + id + \"/status\", {\n          method: \"PATCH\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            status: status\n          })\n        });\n        if (!res.ok) throw new Error(\"Failed to update status\");\n        fetchTickets();\n      } catch (err) {\n        Alert.alert(\"Error\", \"Failed to update status\");\n      }\n    });\n    return function updateStatus(_x, _x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var handleLogout = function () {\n    var _ref4 = _asyncToGenerator(function* () {\n      yield AsyncStorage.removeItem('role');\n      setRole(null);\n    });\n    return function handleLogout() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  useEffect(function () {\n    fetchTickets();\n  }, []);\n  var getStatusColor = function getStatusColor(status) {\n    if (status === \"new\") return \"red\";\n    if (status === \"in_progress\") return \"orange\";\n    return \"green\";\n  };\n  return _jsxs(View, {\n    style: styles.container,\n    children: [_jsxs(View, {\n      style: styles.header,\n      children: [_jsx(Text, {\n        style: styles.heading,\n        children: \"Admin Dashboard\"\n      }), _jsx(Button, {\n        title: \"Logout\",\n        onPress: handleLogout,\n        color: \"#d9534f\"\n      })]\n    }), _jsx(FlatList, {\n      data: tickets,\n      keyExtractor: function keyExtractor(item) {\n        return item._id;\n      },\n      renderItem: function renderItem(_ref5) {\n        var item = _ref5.item;\n        return _jsxs(TouchableOpacity, {\n          style: styles.ticket,\n          onPress: function onPress() {\n            return navigation.navigate(\"TicketDetails\", {\n              ticketId: item._id\n            });\n          },\n          children: [_jsx(Text, {\n            style: styles.title,\n            children: item.description\n          }), _jsxs(Text, {\n            children: [\"Status: \", _jsx(Text, {\n              style: {\n                color: getStatusColor(item.status)\n              },\n              children: item.status.toUpperCase()\n            })]\n          }), _jsxs(View, {\n            style: styles.statusButtons,\n            children: [item.status !== \"new\" && _jsx(Button, {\n              title: \"Set New\",\n              onPress: function onPress() {\n                return updateStatus(item._id, \"new\");\n              }\n            }), item.status !== \"in_progress\" && _jsx(Button, {\n              title: \"In Progress\",\n              onPress: function onPress() {\n                return updateStatus(item._id, \"in_progress\");\n              }\n            }), item.status !== \"resolved\" && _jsx(Button, {\n              title: \"Resolved\",\n              onPress: function onPress() {\n                return updateStatus(item._id, \"resolved\");\n              }\n            })]\n          })]\n        });\n      },\n      contentContainerStyle: {\n        paddingBottom: 20\n      }\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    padding: 20\n  },\n  header: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    marginBottom: 10\n  },\n  heading: {\n    fontSize: 22,\n    fontWeight: \"bold\"\n  },\n  ticket: {\n    padding: 15,\n    borderBottomWidth: 1,\n    borderColor: \"#ccc\",\n    marginBottom: 10,\n    borderRadius: 5,\n    backgroundColor: \"#f9f9f9\"\n  },\n  title: {\n    fontSize: 16,\n    fontWeight: \"500\",\n    marginBottom: 5\n  },\n  statusButtons: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    marginTop: 10\n  }\n});","map":{"version":3,"names":["React","useState","useEffect","View","Text","FlatList","StyleSheet","Button","TouchableOpacity","Alert","AsyncStorage","API_URL","jsx","_jsx","jsxs","_jsxs","AdminDashboard","_ref","navigation","setRole","_useState","_useState2","_slicedToArray","tickets","setTickets","fetchTickets","_ref2","_asyncToGenerator","res","fetch","data","json","err","console","error","alert","apply","arguments","updateStatus","_ref3","id","status","method","headers","body","JSON","stringify","ok","Error","_x","_x2","handleLogout","_ref4","removeItem","getStatusColor","style","styles","container","children","header","heading","title","onPress","color","keyExtractor","item","_id","renderItem","_ref5","ticket","navigate","ticketId","description","toUpperCase","statusButtons","contentContainerStyle","paddingBottom","create","flex","padding","flexDirection","justifyContent","alignItems","marginBottom","fontSize","fontWeight","borderBottomWidth","borderColor","borderRadius","backgroundColor","marginTop"],"sources":["C:/Users/anilb/OneDrive/Desktop/zealthy-helpdesk/zealthy-helpdesk/frontend/screens/AdminDashboard.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { View, Text, FlatList, StyleSheet, Button, TouchableOpacity, Alert } from \"react-native\";\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { API_URL } from \"../config\";\r\n\r\nexport default function AdminDashboard({ navigation, setRole }) {\r\n  const [tickets, setTickets] = useState([]);\r\n\r\n  // Fetch all tickets\r\n  const fetchTickets = async () => {\r\n    try {\r\n      const res = await fetch(`${API_URL}/api/tickets`);\r\n      const data = await res.json();\r\n      setTickets(data);\r\n    } catch(err){ console.error(err); Alert.alert(\"Error\", \"Failed to fetch tickets\"); }\r\n  };\r\n\r\n  // Update ticket status\r\n  const updateStatus = async (id, status) => {\r\n    try {\r\n      const res = await fetch(`${API_URL}/api/tickets/${id}/status`, {\r\n        method:\"PATCH\",\r\n        headers:{ \"Content-Type\":\"application/json\" },\r\n        body: JSON.stringify({status})\r\n      });\r\n      if (!res.ok) throw new Error(\"Failed to update status\");\r\n      fetchTickets();\r\n    } catch(err){ Alert.alert(\"Error\",\"Failed to update status\"); }\r\n  };\r\n\r\n  // Logout\r\n  const handleLogout = async () => {\r\n    await AsyncStorage.removeItem('role');\r\n    setRole(null);\r\n  };\r\n\r\n  useEffect(() => { fetchTickets(); }, []);\r\n\r\n  // Get color based on status\r\n  const getStatusColor = (status) => {\r\n    if (status === \"new\") return \"red\";\r\n    if (status === \"in_progress\") return \"orange\";\r\n    return \"green\";\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <View style={styles.header}>\r\n        <Text style={styles.heading}>Admin Dashboard</Text>\r\n        <Button title=\"Logout\" onPress={handleLogout} color=\"#d9534f\"/>\r\n      </View>\r\n\r\n      <FlatList\r\n        data={tickets}\r\n        keyExtractor={item => item._id}\r\n        renderItem={({item}) => (\r\n          <TouchableOpacity \r\n            style={styles.ticket} \r\n            onPress={() => navigation.navigate(\"TicketDetails\", { ticketId: item._id })}\r\n          >\r\n            <Text style={styles.title}>{item.description}</Text>\r\n            <Text>Status: <Text style={{ color: getStatusColor(item.status) }}>{item.status.toUpperCase()}</Text></Text>\r\n\r\n            <View style={styles.statusButtons}>\r\n              {item.status !== \"new\" && <Button title=\"Set New\" onPress={() => updateStatus(item._id, \"new\")} />}\r\n              {item.status !== \"in_progress\" && <Button title=\"In Progress\" onPress={() => updateStatus(item._id, \"in_progress\")} />}\r\n              {item.status !== \"resolved\" && <Button title=\"Resolved\" onPress={() => updateStatus(item._id, \"resolved\")} />}\r\n            </View>\r\n          </TouchableOpacity>\r\n        )}\r\n        contentContainerStyle={{ paddingBottom: 20 }}\r\n      />\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container:{ flex:1, padding:20 },\r\n  header:{ flexDirection:\"row\", justifyContent:\"space-between\", alignItems:\"center\", marginBottom:10 },\r\n  heading:{ fontSize:22, fontWeight:\"bold\" },\r\n  ticket:{ padding:15, borderBottomWidth:1, borderColor:\"#ccc\", marginBottom:10, borderRadius:5, backgroundColor:\"#f9f9f9\" },\r\n  title:{ fontSize:16, fontWeight:\"500\", marginBottom:5 },\r\n  statusButtons:{ flexDirection:\"row\", justifyContent:\"space-between\", marginTop:10 }\r\n});\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}